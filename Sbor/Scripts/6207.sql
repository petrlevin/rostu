-- По задаче CORE-967 справочник Агрегатные функции заменяется на перечисление, чтобы значения перечисления явно использовались в коде
-- На ревизии 6207 было добавлено поле EntityFieldSettings.idAggregate - ссылка на перечисление.
-- В этом скрипте это поле заполняется значением SUM для полей сущности, у которых указана ф-ция агрегации SUM. 
-- Далее коммитов будет удалено поле idAggregateFunction.
if exists(select * from sys.columns where Name = N'idAggregate' and Object_ID = Object_ID(N'ref.EntityFieldSetting'))
BEGIN
DECLARE @com NVARCHAR(MAX)
SELECT @com = 'update ref.EntityFieldSetting set idAggregate = 1 where id IN ( -2013265889,-2013265888,-2013265887,-2013265886,-2013265885,-2013265884,-2013265883,-2013265882,-2013265881,-2013265880,-2013265879,-2013265878,-2013265877,-2013265876,-2013265875,-2013265874,-2013265873,-2013265872,-1946157026,-1946157025,-1946157024,-1946157023,-1811939300,-1744830436,-1744830434,-1275068385,-1275068384,-1275068383,-1275068382,-1275068381,-1275068380,-1275068379,-1275068378,-1207959533,-1207959532,-1207959531,-1207959526,-1207959525,-1207959524,-1207959523,-1207959522,-1207959521,-1207959520,-1207959519,-1207959518,-1207959517,-1207959516,-1207959515,-1207959514,-1207959513,-1207959512,-1207959511,-1207959510,-1207959509,-1207959508,-1207959507,-1207959506,-1207959505,-1207959504,-1207959503,-1207959502,-1207959501,-1207959500,-1207959499,-1207959498,-1207959497,-1207959496,-1207959495,-1207959494)'
EXEC (@com)
END
